# üîí Common Web Vulnerabilities Guide

A beginner-friendly guide to understanding the most common web security vulnerabilities.

---

## Table of Contents

1. [Cross-Site Scripting (XSS)](#cross-site-scripting-xss)
2. [SQL Injection (SQLi)](#sql-injection-sqli)
3. [Insecure Direct Object References (IDOR)](#insecure-direct-object-references-idor)

---

## Cross-Site Scripting (XSS)

### What is XSS?

Cross-Site Scripting (XSS) is a vulnerability that allows attackers to inject malicious JavaScript code into web pages viewed by other users. When the victim's browser loads the page, the malicious script executes with full access to the page's data, cookies, and session tokens.

### How Does It Work?

```
Normal Flow:
User ‚Üí Input: "Hello World" ‚Üí Server ‚Üí Page displays: "Hello World"

XSS Attack:
Attacker ‚Üí Input: "<script>alert('XSS')</script>" ‚Üí Server ‚Üí Browser executes script!
```

### Types of XSS

#### 1. Reflected XSS
The malicious script is part of the request and immediately reflected back to the user.

**Example:**
```
Vulnerable URL: https://example.com/search?q=<script>alert('XSS')</script>

The page displays:
You searched for: <script>alert('XSS')</script>
                  ‚Üë This executes in the victim's browser!
```

#### 2. Stored XSS (Persistent)
The malicious script is stored in the database and displayed to all users who view that data.

**Example:**
```
Attacker posts comment: "<script>steal_cookies()</script>"
                          ‚Üì
                    Stored in database
                          ‚Üì
              Every user who views the page
                          ‚Üì
                Script executes for ALL users!
```

#### 3. DOM-Based XSS
The vulnerability exists in client-side JavaScript code that processes user input unsafely.

**Example:**
```javascript
// Vulnerable code
var name = location.hash.substring(1);
document.getElementById('welcome').innerHTML = "Hello " + name;

// Attack URL
https://example.com/page#<img src=x onerror=alert('XSS')>
```

### Real-World Impact

- **Cookie Theft**: Steal session cookies to hijack accounts
- **Keylogging**: Capture everything the user types
- **Phishing**: Create fake login forms
- **Defacement**: Change the appearance of the website
- **Redirect**: Send users to malicious websites

### How to Prevent XSS

```
‚úÖ DO:
- Encode all output (convert < to &lt;, > to &gt;, etc.)
- Use Content Security Policy (CSP) headers
- Validate and sanitize all input
- Use frameworks that automatically escape output (React, Angular)

‚ùå DON'T:
- Directly insert user input into HTML
- Trust data from the URL, cookies, or database
- Use innerHTML or eval() with user-controlled data
```

**Code Example - Vulnerable:**
```php
<?php
echo "Hello " . $_GET['name']; // VULNERABLE!
?>
```

**Code Example - Safe:**
```php
<?php
echo "Hello " . htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8'); // SAFE
?>
```

---

## SQL Injection (SQLi)

### What is SQL Injection?

SQL Injection is a vulnerability that allows attackers to interfere with database queries. By injecting malicious SQL code into input fields, attackers can read, modify, or delete database data they shouldn't have access to.

### How Does It Work?

```
Normal Query:
SELECT * FROM users WHERE username = 'john' AND password = 'secret123'
                                        ‚Üë User input

SQL Injection:
Input username: admin' --
Input password: anything

Resulting Query:
SELECT * FROM users WHERE username = 'admin' -- ' AND password = 'anything'
                                           ‚Üë Comment out the rest!
                                           (-- is SQL comment syntax)
Result: Logs in as admin without knowing the password!
```

### Visual Representation

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Login Form                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Username: admin' --               ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Password: [anything]              ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ         [Login Button]                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Server builds query:                   ‚îÇ
‚îÇ  SELECT * FROM users                    ‚îÇ
‚îÇ  WHERE username = 'admin' --            ‚îÇ
‚îÇ        AND password = 'xxx'             ‚îÇ
‚îÇ                       ‚Üë Commented out!  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
    Login Success!
```

### Common SQL Injection Techniques

#### 1. Authentication Bypass
```sql
-- Input: ' OR '1'='1
SELECT * FROM users WHERE username = '' OR '1'='1' AND password = ''
-- Always true, returns all users!
```

#### 2. Data Extraction
```sql
-- Input: ' UNION SELECT username, password FROM users --
-- Retrieves all usernames and passwords from the database
```

#### 3. Data Modification
```sql
-- Input: '; UPDATE users SET password = 'hacked' WHERE username = 'admin' --
-- Changes admin password!
```

#### 4. Data Deletion
```sql
-- Input: '; DROP TABLE users; --
-- Deletes the entire users table!
```

### Real-World Impact

- **Data Breach**: Steal entire databases (credit cards, passwords, personal info)
- **Authentication Bypass**: Login as any user, including administrators
- **Data Tampering**: Modify or delete critical data
- **Server Takeover**: In some cases, execute operating system commands

### How to Prevent SQL Injection

```
‚úÖ DO:
- Use parameterized queries (prepared statements)
- Use ORM frameworks that handle escaping
- Apply least privilege to database accounts
- Validate and whitelist input where possible
- Use stored procedures (with proper parameterization)

‚ùå DON'T:
- Concatenate user input directly into SQL queries
- Trust any input (forms, URLs, cookies, headers)
- Display detailed error messages to users
```

**Code Example - Vulnerable:**
```python
# VULNERABLE!
query = "SELECT * FROM users WHERE username = '" + username + "'"
cursor.execute(query)
```

**Code Example - Safe:**
```python
# SAFE - using parameterized query
query = "SELECT * FROM users WHERE username = ?"
cursor.execute(query, (username,))
```

**Code Example - Safe (Python with ORM):**
```python
# SAFE - using ORM
user = User.objects.get(username=username)
```

---

## Insecure Direct Object References (IDOR)

### What is IDOR?

IDOR occurs when an application exposes a direct reference to an internal object (like a database key, filename, or user ID) without proper authorization checks. Attackers can simply modify the reference to access other users' data.

### How Does It Work?

```
Scenario: Viewing your profile
URL: https://bank.com/account?id=12345
           Your account shows balance: $5,000

Attacker changes URL to:
URL: https://bank.com/account?id=12346
           Someone else's account shows balance: $50,000!
```

### Visual Example

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ User Alice (ID: 100)                         ‚îÇ
‚îÇ URL: /profile?user_id=100                    ‚îÇ
‚îÇ ‚úì Shows Alice's data                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Attacker changes URL                         ‚îÇ
‚îÇ URL: /profile?user_id=101                    ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ Server checks: "user_id exists? YES"        ‚îÇ
‚îÇ Server checks: "is user authorized? NO!"    ‚îÇ
‚îÇ ‚Üê This check is MISSING in vulnerable apps! ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ ‚úó Shows Bob's data (user ID: 101)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Real-World Examples

#### 1. Document Access
```
Vulnerable:
GET /download?file=invoice_123.pdf
GET /download?file=invoice_124.pdf  ‚Üê Try other numbers!

Impact: Access other customers' invoices
```

#### 2. User Profile Access
```
Vulnerable:
GET /api/users/5/profile
GET /api/users/6/profile  ‚Üê Enumerate users!

Impact: Access other users' personal information
```

#### 3. Order Details
```
Vulnerable:
GET /orders/view/789
GET /orders/view/790  ‚Üê Try sequential IDs!

Impact: View other customers' orders and addresses
```

### Testing for IDOR

```
Step 1: Login as User A
Step 2: Note your resource IDs (profile ID, document ID, etc.)
Step 3: Login as User B (or create a second account)
Step 4: Try to access User A's resources using User B's session
Step 5: If you can access them ‚Üí IDOR vulnerability exists!
```

### Real-World Impact

- **Privacy Violation**: Access to other users' personal data
- **Financial Loss**: View/modify other users' financial information
- **Privilege Escalation**: Access admin functions by guessing admin IDs
- **Data Harvesting**: Enumerate and download all records

### How to Prevent IDOR

```
‚úÖ DO:
- Always verify the user is authorized to access the resource
- Use random, unpredictable identifiers (UUIDs instead of sequential IDs)
- Implement access control checks on the server
- Use indirect references (like mapping tables)
- Log access attempts for security monitoring

‚ùå DON'T:
- Rely on hiding or obfuscating references
- Trust that users won't guess IDs
- Only check if the resource exists (also check authorization!)
- Use predictable sequential IDs for sensitive resources
```

**Code Example - Vulnerable:**
```javascript
// VULNERABLE!
app.get('/document/:id', (req, res) => {
  const doc = db.getDocument(req.params.id);
  res.send(doc); // No authorization check!
});
```

**Code Example - Safe:**
```javascript
// SAFE
app.get('/document/:id', (req, res) => {
  const doc = db.getDocument(req.params.id);
  
  // Check if the logged-in user owns this document
  if (doc.owner_id !== req.session.user_id) {
    return res.status(403).send('Access denied');
  }
  
  res.send(doc);
});
```

---


## Summary

### Quick Reference Table

| Vulnerability | What It Is | Key Prevention |
|--------------|-----------|----------------|
| **XSS** | Injecting malicious scripts into web pages | Encode output, use CSP, sanitize input |
| **SQL Injection** | Injecting SQL code to manipulate database | Use parameterized queries, never concatenate SQL |
| **IDOR** | Accessing objects without authorization | Always verify authorization, use UUIDs |


### General Security Principles

```
1. Defense in Depth
   ‚Üí Multiple layers of security controls

2. Least Privilege
   ‚Üí Grant minimum necessary permissions

3. Fail Securely
   ‚Üí Errors should not expose information or grant access

4. Never Trust Input
   ‚Üí Validate and sanitize all user input

5. Keep It Simple
   ‚Üí Complex systems are harder to secure

6. Security by Design
   ‚Üí Build security in from the start, not as an afterthought
```

### Learning Resources

**Practice Platforms:**
- [Bwapp](http://www.itsecgames.com/) - Broken webapp with over 100 vuln
- [PortSwigger Web Security Academy](https://portswigger.net/web-security) - Free online training
- [HackTheBox](https://www.hackthebox.com/) - Penetration testing labs
- [TryHackMe](https://tryhackme.com/) - Guided cybersecurity training

**Reference Materials:**
- [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings) - Swisskey repository with info on every known vuln
- [PortSwigger Academy ](https://portswigger.net/web-security) - Very Valuable documentation


---

**Remember:** The best defense is understanding how attacks work. Stay curious, keep learning, and always code with security in mind! üîê
